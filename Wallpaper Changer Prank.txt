
REM Change Wallpaper
REM Author: @Lets-get-Hacky
REM Description: Uses Powershell to retrieve an image from a specified URL and sets it as the wallpaper.
REM Target: Windows 10 and 11

REM Change INSERT_IMAGE_URL_HERE to a direct link for an image.

DEFAULT_DELAY 100
GUI R
DELAY 750
STRING powershell
ENTER 
DELAY 2500

STRING $url = "INSERT_IMAGE_URL_HERE";$outputPath = "$env:temp\img.jpg";$wallpaperStyle = 2;IWR -Uri $url -OutFile $outputPath
STRING ;$signature = 'using System;using System.Runtime.InteropServices;public class Wallpaper {[DllImport("user32.dll", CharSet = CharSet.Auto)]public static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);}'
STRING ;Add-Type -TypeDefinition $signature;$SPI_SETDESKWALLPAPER = 0x0014;$SPIF_UPDATEINIFILE = 0x01;$SPIF_SENDCHANGE = 0x02;[Wallpaper]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $outputPath, $SPIF_UPDATEINIFILE -bor $SPIF_SENDCHANGE)
STRING ;sleep 1;exit

DELAY 500
ENTER